# Rendering Configuration
# BlenderProc rendering with segmentation masks

# Camera positions and orientations
# Each camera generates one render per sample
cameras:
  - position: [0.0, 0.0, 0.3]      # [x, y, z] in meters (top-down view)
    rotation: [0.0, 0.0, 0.0]      # Euler angles in radians [x, y, z]

  # Uncomment to add more camera angles:
  # - position: [0.05, 0.05, 0.25]  # Slight angle
  #   rotation: [0.1, 0.0, 0.0]

# Lighting configuration
lighting:
  # Main sun lamp (directional light)
  sun:
    energy: 2.0                    # Light intensity
    location: [0, 0, 1.0]          # [x, y, z] in meters
    rotation: [0, 0, 0]            # Euler angles in radians

  # Fill lights (point lights for soft fill)
  fill_lights:
    - location: [0.3, 0.3, 0.5]    # Top-right fill
      energy: 0.6

    - location: [-0.3, 0.3, 0.5]   # Top-left fill
      energy: 0.6

    - location: [0.3, -0.3, 0.5]   # Bottom-right fill
      energy: 0.6

    - location: [-0.3, -0.3, 0.5]  # Bottom-left fill
      energy: 0.6

# Background settings
background:
  color: [0.8, 0.8, 0.8]           # RGB background color (light grey)
  # Future: HDRI environment maps for realistic reflections

# Domain Randomization Settings
# Enable these to vary rendering parameters across samples for better model generalization
domain_randomization:
  enabled: true                    # Master switch for all randomization

  # Lighting randomization
  lighting:
    sun_energy_range: [1.5, 3.0]   # Randomize sun intensity
    sun_rotation_range:            # Randomize sun angle (radians)
      x: [-0.3, 0.3]               # Pitch variation
      y: [-0.3, 0.3]               # Yaw variation
      z: [0.0, 6.28]               # Full rotation around Z-axis
    fill_energy_range: [0.3, 0.9]  # Randomize fill light intensity

  # Camera randomization
  camera:
    position_offset_range:         # Add random offset to camera position
      x: [-0.02, 0.02]             # ±2cm horizontal offset
      y: [-0.02, 0.02]             # ±2cm vertical offset
      z: [0.0, 0.0]                # Keep height constant
    rotation_offset_range:         # Add random tilt to camera
      x: [-0.1, 0.1]               # ±5.7° pitch
      y: [-0.1, 0.1]               # ±5.7° roll
      z: [-0.2, 0.2]               # ±11.5° yaw rotation

  # Background randomization
  background:
    randomize_color: true
    color_options:                 # List of possible background colors
      - [0.95, 0.95, 0.95]         # White/light grey (clean)
      - [0.8, 0.8, 0.8]            # Medium grey (default)
      - [0.6, 0.6, 0.6]            # Dark grey
      - [0.9, 0.85, 0.75]          # Beige/desk color
      - [0.7, 0.65, 0.55]          # Wood brown
      - [0.3, 0.3, 0.35]           # Dark surface

  # Soldermask color randomization
  soldermask:
    randomize_color: true
    color_options:                 # Common PCB soldermask colors
      - name: "green"
        rgb: [0.05, 0.3, 0.05]     # Traditional green
        metallic: 0.1
        roughness: 0.4
      - name: "blue"
        rgb: [0.05, 0.1, 0.4]      # Blue
        metallic: 0.1
        roughness: 0.35
      - name: "red"
        rgb: [0.4, 0.05, 0.05]     # Red
        metallic: 0.1
        roughness: 0.4
      - name: "black"
        rgb: [0.02, 0.02, 0.02]    # Black (matte)
        metallic: 0.05
        roughness: 0.5
      - name: "white"
        rgb: [0.8, 0.8, 0.8]       # White
        metallic: 0.05
        roughness: 0.35
      - name: "yellow"
        rgb: [0.6, 0.5, 0.05]      # Yellow
        metallic: 0.1
        roughness: 0.4
      - name: "purple"
        rgb: [0.3, 0.05, 0.3]      # Purple (rare)
        metallic: 0.1
        roughness: 0.4

  # Board shape randomization
  board:
    randomize_shape: true
    shape_options:
      - rectangular                # Standard rectangular board
      - rounded_corners            # Rounded corner board
      - circular                   # Circular board (for specialized applications)

# Rendering resolution
# Can be overridden by pipeline config for multi-resolution generation
resolution: 1024                    # Width and height in pixels (square images) - TESTING: use 512, PRODUCTION: use 2048

# Render quality settings
render:
  samples: 128                      # Ray tracing samples (higher = better quality, slower) - TESTING: use 32, PRODUCTION: use 128
  denoise: true                    # Enable denoising for cleaner images
  use_gpu: true                    # Use GPU if available (much faster)

# Segmentation settings
segmentation:
  # Category mapping:
  #   0 = Background (default)
  #   1 = Metal/Probable (solder joints, pins, pads, exposed copper)
  #   2 = Non-metal (plastic/ceramic component bodies, soldermask)

  # Segmentation maps to generate
  maps:
    - category_id                  # Semantic segmentation (metal vs non-metal)
    - material                     # Per-material segmentation
    - instance                     # Instance segmentation (separate objects)
    - name                         # Per-object segmentation

  # Material detection for category assignment
  material_detection:
    # Keywords in material names that indicate metal
    metal_keywords:
      - solder
      - copper
      - pad
      - metal
      - tin

    # Mat4cad BSDF properties
    # mat_base: 0 = plastic/ceramic, 2 = metal
    use_mat4cad_detection: true

# Depth rendering
depth:
  enabled: true                    # Enable depth map rendering
  antialiasing: false              # Disable antialiasing for precise depth values

# Output format
output:
  format: hdf5                     # hdf5 (BlenderProc default, efficient)
  compression: gzip                # Compression for HDF5 files
  compression_level: 4             # Compression level (0-9, higher = smaller but slower)
